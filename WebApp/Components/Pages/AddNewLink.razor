@page "/AddNewLink"
@rendermode InteractiveServer
@using System.Text.Json
@using WebApp.Helpers
@inject LocalStorageService LocalStorage
@inject NavigationManager Navigation

<h3>Add new rss feed</h3>


<form method="post" @onsubmit="Submit">
    <label class="link-label">Link:
        <InputText class="link-input" @bind-Value="link"></InputText>
    </label>
    <button class="save-button" type="submit">Add new</button>
</form>
<br/>
<NavLink href="FeedLinks">
    Back to the links
</NavLink>

@code {
    public string link;

    private async void Submit()
    {
        var storeItems = await LocalStorage.GetItem("items");

        var links = JsonSerializer.Deserialize<List<string>>(storeItems);
        
        links.Add(link);

        await LocalStorage.AddLink("items", JsonSerializer.Serialize(links));
        Navigation.NavigateTo("FeedLinks");
    }
}